<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Real-Time On-Device Flow Statistics Detection and Prediction - Ryan's Blog</title><meta name=Description content="Yet another documentation of life."><meta property="og:title" content="Real-Time On-Device Flow Statistics Detection and Prediction">
<meta property="og:description" content="This project was served as the Undergraduate Major Design Experience at UM-SJTU Joint Institute, Shanghai Jiao Tong University.
Background: The Impact of COVID-19 The outbreak of novel coronavirus COVID-19 in 2020 has brought huge attention to the administration of human society. &ldquo;Social distancing&rdquo; has been advocated as a very effective method to fight the virus. In order to facilitate the implementation of social distancing, we propose an idea of building a portable device that is capable of detect and predict flow statistics in real time, in order to provide insights and suggestions for traffic management."><meta property="og:type" content="article"><meta property="og:url" content="https://zhihaoruan.xyz/450proj/"><meta property="og:image" content="https://zhihaoruan.xyz/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-29T17:40:39-04:00"><meta property="article:modified_time" content="2023-03-30T01:18:30-07:00"><meta property="og:site_name" content="Ryan's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zhihaoruan.xyz/logo.png"><meta name=twitter:title content="Real-Time On-Device Flow Statistics Detection and Prediction"><meta name=twitter:description content="This project was served as the Undergraduate Major Design Experience at UM-SJTU Joint Institute, Shanghai Jiao Tong University.
Background: The Impact of COVID-19 The outbreak of novel coronavirus COVID-19 in 2020 has brought huge attention to the administration of human society. &ldquo;Social distancing&rdquo; has been advocated as a very effective method to fight the virus. In order to facilitate the implementation of social distancing, we propose an idea of building a portable device that is capable of detect and predict flow statistics in real time, in order to provide insights and suggestions for traffic management."><meta name=application-name content="Ryan's Blog"><meta name=apple-mobile-web-app-title content="Ryan's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://zhihaoruan.xyz/450proj/><link rel=prev href=https://zhihaoruan.xyz/ve320-notes/><link rel=next href=https://zhihaoruan.xyz/560proj/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Real-Time On-Device Flow Statistics Detection and Prediction","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/zhihaoruan.xyz\/450proj\/"},"genre":"posts","keywords":"computer vision, raspberry pi, Multi-lingual","wordcount":713,"url":"https:\/\/zhihaoruan.xyz\/450proj\/","datePublished":"2020-08-29T17:40:39-04:00","dateModified":"2023-03-30T01:18:30-07:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Zhihao Ruan"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Ryan's Blog">Ryan's Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/categories/projects/>Projects </a><a class=menu-item href=/categories/my-gallery/>My Gallery </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/450proj/ selected>English</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Ryan's Blog">Ryan's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/categories/projects/ title>Projects</a><a class=menu-item href=/categories/my-gallery/ title>My Gallery</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/450proj/ selected>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Real-Time On-Device Flow Statistics Detection and Prediction</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Zhihao Ruan</a></span>&nbsp;<span class=post-category>included in <a href=/categories/projects/><i class="far fa-folder fa-fw" aria-hidden=true></i>Projects</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-08-29>2020-08-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;713 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/posts/450Proj/450_MorphologicalAnalysis.png data-srcset="/images/posts/450Proj/450_MorphologicalAnalysis.png, /images/posts/450Proj/450_MorphologicalAnalysis.png 1.5x, /images/posts/450Proj/450_MorphologicalAnalysis.png 2x" data-sizes=auto alt=/images/posts/450Proj/450_MorphologicalAnalysis.png title=/images/posts/450Proj/450_MorphologicalAnalysis.png width=1250 height=968></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#background-the-impact-of-covid-19>Background: The Impact of COVID-19</a></li><li><a href=#concept-generation>Concept Generation</a></li><li><a href=#key-technologies>Key Technologies</a><ul><li><a href=#object-detector-mobilenet-ssd>Object Detector: MobileNet-SSD</a></li><li><a href=#object-tracker-kalman-filter>Object Tracker: Kalman Filter</a></li></ul></li><li><a href=#source-code>Source Code</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div></div><div class=content id=content><p><em><strong>This project was served as the Undergraduate Major Design Experience at UM-SJTU Joint Institute, Shanghai Jiao Tong University.</strong></em></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/kMHzTvTi0Lc style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=background-the-impact-of-covid-19>Background: The Impact of COVID-19</h2><p>The outbreak of novel coronavirus COVID-19 in 2020 has brought huge attention to the administration of human society. &ldquo;Social distancing&rdquo; has been advocated as a very effective method to fight the virus. In order to facilitate the implementation of social distancing, we propose an idea of building a portable device that is capable of <em>detect and predict flow statistics in real time</em>, in order to provide insights and suggestions for traffic management.</p><p>With the development of computer vision technology, nowadays it has become much easier and cheaper to put cameras into all parts of industry to perform a variety of detection tasks. In order to make our product cost-efficient, we also decided to take the advantage of computer vision and developed a <em>vision-based</em> solution for real-time flow detection. To ensure that our product is portable to use, we also settled down the plan that our whole system should be running on a Raspberry Pi.</p><h2 id=concept-generation>Concept Generation</h2><figure><img src=450_MorphologicalAnalysis.png alt="Morphological chart." width=500><figcaption><p>Morphological chart.</p></figcaption></figure><p>What constitutes to our product? First, in order to satisfy the basic requirements, our final product must be capable of detecting human traffic flow (i.e. pedestrians) through cameras. Therefore, there must be some part transforming the live video stream into detection results. As a result, we name this part an <strong>object detector.</strong> Second, we need to make sure that our system is capable of assigning &ldquo;identities&rdquo; to objects in the camera frame so that it could detect which person leaves the frame and which person enters the frame and we call this part an <strong>object tracker.</strong> Third, we wish to store a fixed amount of history data so that we could utilize it to predict future flow statistics changes. This means that we also need a <strong>back-end server.</strong> Last but not least, we&rsquo;ll have to display our flow analysis results somewhere. We decided to host them on a self-designed <strong>front-end website.</strong></p><p>From the above morphological analysis, we settled down the final configuration of our product: an object detector, an object tracker, a back-end server, and a front-end website.</p><h2 id=key-technologies>Key Technologies</h2><p>After we settled down the big picture of our project, we then proceeded to conduct tests and develop the final product. After several months of discussions and developments, our final product have utilized the following technologies.</p><h3 id=object-detector-mobilenet-ssd>Object Detector: MobileNet-SSD</h3><p>Deep Neural Networks (DNNs) are the first solution we have thought of for object detection. It has multiple advantages over other techniques such as traditional computer vision methods, including better robustness and lower implementational cost.</p><p>However, not all DNNs are suitable for our project. In fact, most of the state-of-the-art DNN detectors require a lot of computing resources such as high-performance deep learning graphics cards and are generally run on big enterprise servers. Therefore, we have to select the DNN with a relatively high performance and the least required computing resources.</p><p>Finally, <a href=https://arxiv.org/abs/1801.04381 target=_blank rel="noopener noreffer">MobileNet v2</a>-based <a href=https://link.springer.com/chapter/10.1007/978-3-319-46448-0_2 target=_blank rel="noopener noreffer">Single Shot MultiBox Detector</a> (MobileNet-SSD) becomes our final solution, because it is accurate, lightweight, and was specifically designed for mobile devices.</p><h3 id=object-tracker-kalman-filter>Object Tracker: Kalman Filter</h3><p>Kalman filter is a probabilistic model that has been widely used in control theories and applications. Particularly, it has its own <em>states</em> that are hidden from the outer world and only certain state properties can be <em>observed</em> by outer worlds through sensors. The main task of the model is to use a certain amount of observations to predict the next states of the model. Hence, we can utilize this property of Kalman filter and construct one Kalman filter for each object that we&rsquo;re going to track. Once the Kalman filter is constructed, we can utilize the prediction of its position in the next frame and cross-check with the detection results of the next frame to determine whether this object is &ldquo;disappeared.&rdquo;</p><h2 id=source-code>Source Code</h2><p>Unfortunately, due to confidentiality agreement, the source code for this project is not available for now. However, users can always visit our front-end website <a href=https://www.umji-flowdetection.com/ target=_blank rel="noopener noreffer">https://www.umji-flowdetection.com/</a> for further reference.</p><h2 id=acknowledgements>Acknowledgements</h2><p>For the entire work, I would like to express special thanks to:</p><ul><li>our sponsors: Allen Zhu and Allan Zhu from UM-SJTU Joint Institute in Shanghai Jiao Tong University</li><li>my teammates: Jiayu Yi, Zekun LI, Zhikai Chen and Zihao Shen</li><li>my own passion!</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-03-30&nbsp;<a class=git-hash href=https://github.com/shineyruan/shineyruan.github.io/commit/d512269a88b05c47da3764a8128cc1dafa864d38 target=_blank title="commit by Zhihao Ruan(shineyruan@gmail.com) d512269a88b05c47da3764a8128cc1dafa864d38: multilingual support">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>d512269</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/450proj/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://zhihaoruan.xyz/450proj/ data-title="Real-Time On-Device Flow Statistics Detection and Prediction" data-hashtags="computer vision,raspberry pi,Multi-lingual"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://zhihaoruan.xyz/450proj/ data-hashtag="computer vision"><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://zhihaoruan.xyz/450proj/ data-title="Real-Time On-Device Flow Statistics Detection and Prediction"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://zhihaoruan.xyz/450proj/ data-title="Real-Time On-Device Flow Statistics Detection and Prediction"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://zhihaoruan.xyz/450proj/ data-title="Real-Time On-Device Flow Statistics Detection and Prediction" data-image=/images/posts/450Proj/450_MorphologicalAnalysis.png><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/computer-vision/>computer vision</a>,&nbsp;<a href=/tags/raspberry-pi/>raspberry pi</a>,&nbsp;<a href=/tags/multi-lingual/>Multi-lingual</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/ve320-notes/ class=prev rel=prev title="Introduction to Semiconductor Devices"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Introduction to Semiconductor Devices</a>
<a href=/560proj/ class=next rel=next title="Minecraft Game Programming">Minecraft Game Programming<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.120.4">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Zhihao Ruan</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>